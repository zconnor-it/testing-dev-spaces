# Editor definition that runs Jupyter Notebook instead of VS Code
# Based on: https://eclipse.dev/che/docs/stable/administration-guide/configuring-editors-definitions/
schemaVersion: 2.2.2

metadata:
  name: no-vscode
  displayName: Jupyter Notebook (No VS Code)
  description: Jupyter Notebook workspace without VS Code
  tags:
    - Jupyter
    - Python
    - DataScience
    - No-IDE
  attributes:
    title: Jupyter Notebook Workspace
    arch:
      - x86_64
      - arm64
    publisher: redhat-custom
    version: 1.0.0
    repository: https://github.com/zconnor-it/testing-dev-spaces
    firstPublicationDate: '2024-01-01'
    iconMediatype: image/svg+xml
    iconData: |
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
        <circle cx="12" cy="12" r="10" fill="#F37626" />
        <text x="12" y="16" text-anchor="middle" font-size="10" fill="white" font-weight="bold">J</text>
      </svg>

components:
  # Persistent volume for projects/notebooks
  - name: projects
    volume:
      size: 5Gi

  # Jupyter Notebook container
  - name: jupyter-notebook
    attributes:
      controller.devfile.io/container-contribution: true
    container:
      image: 'quay.io/jupyter/minimal-notebook:latest'
      memoryLimit: 4Gi
      memoryRequest: 1Gi
      cpuLimit: '2'
      cpuRequest: '500m'
      mountSources: true
      sourceMapping: /home/jovyan/projects
      volumeMounts:
        - name: projects
          path: /home/jovyan/projects
      command:
        - /bin/bash
      args:
        - -c
        - |
          echo "Starting Jupyter Notebook..."
          start-notebook.sh --ip=0.0.0.0 --port=8888 --no-browser --NotebookApp.token='' --NotebookApp.password='' --NotebookApp.allow_origin='*'
      env:
        - name: JUPYTER_ENABLE_LAB
          value: "yes"
        - name: NB_USER
          value: "jovyan"
      endpoints:
        - name: jupyter
          targetPort: 8888
          exposure: public
          protocol: https
          attributes:
            type: main
            cookiesAuthEnabled: true
            urlRewriteSupported: true
            discoverable: true
