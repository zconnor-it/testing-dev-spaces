# Example Devfile for OpenShift Dev Spaces WITHOUT VS Code
# This devfile uses editorFree: true to prevent any IDE from starting
# Users access Jupyter Notebook directly via the exposed endpoint
#
# Reference: https://eclipse.dev/che/docs/stable/administration-guide/configuring-editors-definitions/

schemaVersion: 2.3.0

attributes:
  # This is the key attribute that prevents VS Code from starting
  editorFree: true
  
  # Alternative: Use a specific editor definition instead of editorFree
  # che-editor: redhat-custom/no-vscode/1.0.0

metadata:
  name: devspaces-jupyter
  displayName: Devspaces Jupyter Notebook
  description: "OpenShift Dev Spaces Jupyter Notebook - No VS Code"
  icon: https://raw.githubusercontent.com/devfile-samples/devfile-stack-icons/main/python.svg
  tags:
    - DataScience
    - Python
    - Jupyter
    - MachineLearning
    - No-VSCode
  projectType: Python
  language: Python
  version: 1.0.0

components:
  - name: runtime
    container:
      # Using official Jupyter minimal-notebook image
      image: quay.io/jupyter/minimal-notebook:latest
      command: ["start-notebook.sh"]
      args: ["--ip=0.0.0.0", "--port=8888", "--no-browser", "--NotebookApp.token=''", "--NotebookApp.password=''"]
      memoryLimit: '4Gi'
      memoryRequest: '1Gi'
      cpuLimit: '2'
      cpuRequest: '500m'
      endpoints:
        - name: jupyter
          targetPort: 8888
          exposure: public
          protocol: https
          attributes:
            # This makes Jupyter the main URL shown to users
            type: main
            cookiesAuthEnabled: true
            urlRewriteSupported: true
      env:
        - name: NB_USER
          value: "jovyan"
